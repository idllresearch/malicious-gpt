# Quality evaluation of Malla-generated Content

Claim: ``` The results of the quality assessment on Malla generated content across different metrics are same or very close to the result reported in Table 3.```

## Execution

Use the Malla **service** as an example. To evaluate the Malla in **poe** and **flowgpt**, follow the same procedure (for the procedures, see [More Guide](https://github.com/idllresearch/malicious-gpt/blob/main/quality/MoreGuide.md)).

### *Step 1. Exam performance for each metric*

**Step 1.1: Code format compliance (F), compilability (C), validity (V)**

- Check Python code on format compliance and compilability.

```shell
cd /home/malicious-gpt/quality/services/Python
python scanner.py
```

- Check C/C++ code on format compliance and compilability.

```shell
cd /home/malicious-gpt/quality/services/C++
python scanner.py
```

- Check HTML code and pages on format compliance and validity. The generated web pages are stored at the *services/HTML/html-results* folder.

```shell
cd /home/malicious-gpt/quality/services/HTML
python scanner.py
```

- Summarize above results as files in the **CodeSyn** folder

```shell
cd /home/malicious-gpt/quality/services/
python sumCompilable.py
```

**Step 1.2: Code evasiveness (E)**

- Check code of Python, C/C++, and HTML on evasiveness against the virus detector (VirusTotal). Generate files in the **codeDetection** folder. Before running the code, please add your VirusTotal API in **VTscanner.py**.

```shell
cd /home/malicious-gpt/quality/services/VirusTotalDetect
python VTscanner.py
```

**Step 1.3: Email format compliance (F) and readability (R)**

- Check emails on format compliance and readability. Generate files in the **mailFluency** folder.

```shell
cd /home/malicious-gpt/quality/services/fluency
python fluency_scanner.py
```

**Step 1.4: Email evasiveness (E)**

- Check emails on evasiveness against the phishing detector (OOPSpam). Generate files in the **mailDetection** folder. Before running the code, please add your OOPSpam API in **oopspam_detect.py**.

```shell
cd /home/malicious-gpt/quality/services/OOPSpamDetect
python scanner.py
```

### *Step 2: Summarize the checking results for each metric*

Run the following script:

```shell
cd /home/malicious-gpt/quality/services
python services_quality_evaluation.py
```



## Environment

- OS: Windows (need **Clang** to analyze the malicious C++ code targeting Windows)

- Python package:

```
textstat
tqdm
clang
```

- Note: 

When running *./C++/scanner.py*, you might meet the [issue with Clang](https://stackoverflow.com/questions/22730935/why-cant-this-python-script-find-the-libclang-dll).  In order to run *./C++/scanner.py*, it is necessary to install Clang on Windows. Here is the [Clang installation method](https://www.wikihow.com/Install-Clang-on-Windows).



## Dataset 

**Step 1:** 

The input is the content generated by Malicious LLMs, which is stored at [malicious_LLM_responses](https://github.com/idllresearch/malicious-gpt/tree/main/malicious_LLM_responses). 
**Step 2:**

 After executing Step 1, you will get four subfolders, i.e., `codeSyn`, `codeDetection`, `mailFluency`, and `mailDetection`. 

We also provided the results of Step 1 (we call the intermediary result) at: 

- For Malla services evaluation: https://github.com/idllresearch/malicious-gpt/tree/main/quality/services

- For Poe's Malla project evaluation: https://github.com/idllresearch/malicious-gpt/tree/main/quality/poe

- For FlowGPT's Malla project evaluation: https://github.com/idllresearch/malicious-gpt/tree/main/quality/flowgpt

## Folder structure

- `C` contains the script for evaluating the format compliance and compilability of malicious code of C language.
- `Python` contains the script for evaluating the format compliance and compilability of malicious code of Python.
- `HTML` contains the script for evaluating the format compliance and validation of phishing webpages.
- `sumCompilable.py` is the script for summarizing the results on format compliance and compilability/validation of malicious code and phishing webpages.
- `VirusTotalDetect` contains the script for evaluating the evasiveness of malicious code and phishing webpages.
- `fluency` contains the script for evaluating the format compliance and readability of phishing emails.
- `OOPSpamDetect` contains the script for evaluating the evasiveness of malicious code and phishing emails.
- `services_quality_evaluation.py` is the script for summarizing all the results of malicious code, phishing webpages, and phishing emails.
- `codeSyn` contains the evaluation results of malicious code and phishing website regarding format compliance and compilability/validation. 
- `codeDetection` contains the evaluation results of malicious code and phishing website regarding evasiveness, in which the detection is conduct by VirusTotal. 
- `mailFluency` contains the evaluation results of phishing mails regarding format compliance and readability. 
- `mailDetection` contains the evaluation results of phishing mails regarding evasiveness, in which the detection is conduct by OOPSpam.

## Result

**Malla services**

The script is expected to print:

```
BadGPT
Malicious code -> F: 0.35, C: 0.22, E: 0.19 | Mail -> F: 0.80, R: 0.13, E: 0.00 | Website -> F: 0.20, V: 0.13, E: 0.13
-----
CodeGPT
Malicious code -> F: 0.52, C: 0.29, E: 0.22 | Mail -> F: 0.53, R: 0.27, E: 0.00 | Website -> F: 0.20, V: 0.13, E: 0.13
-----
DarkGPT
Malicious code -> F: 1.00, C: 0.65, E: 0.63 | Mail -> F: 1.00, R: 0.87, E: 0.13 | Website -> F: 0.80, V: 0.33, E: 0.33
-----
EscapeGPT
Malicious code -> F: 0.78, C: 0.67, E: 0.67 | Mail -> F: 1.00, R: 0.50, E: 0.25 | Website -> F: 1.00, V: 1.00, E: 1.00
-----
EvilGPT
Malicious code -> F: 1.00, C: 0.54, E: 0.51 | Mail -> F: 1.00, R: 0.93, E: 0.27 | Website -> F: 0.80, V: 0.20, E: 0.13
-----
FreedomGPT
Malicious code -> F: 0.90, C: 0.21, E: 0.21 | Mail -> F: 1.00, R: 0.87, E: 0.13 | Website -> F: 0.60, V: 0.00, E: 0.00
-----
MakerGPT
Malicious code -> F: 0.24, C: 0.11, E: 0.11 | Mail -> F: 0.07, R: 0.00, E: 0.00 | Website -> F: 0.20, V: 0.13, E: 0.13
-----
WolfGPT
Malicious code -> F: 0.89, C: 0.52, E: 0.52 | Mail -> F: 1.00, R: 1.00, E: 0.67 | Website -> F: 0.67, V: 0.13, E: 0.13
-----
XXXGPT
Malicious code -> F: 0.14, C: 0.05, E: 0.05 | Mail -> F: 0.07, R: 0.00, E: 0.00 | Website -> F: 0.40, V: 0.27, E: 0.27
-----
```

**Malla services projects on Poe**

The script is expected to print:

```
Quality of content generated by Mallas on Poe.com
Malicious code:
F: 0.37+-0.26, C: 0.25+-0.18, E: 0.24+-0.16
Email:
F: 0.44+-0.29, R: 0.21+-0.21, E: 0.05+-0.08
Web:
F: 0.32+-0.22, V: 0.21+-0.19, E: 0.21+-0.19
```

**Malla services projects on FlowGPT**

The script is expected to print:

```
Quality of content generated by Mallas on FlowGPT.com
Malicious code:
F: 0.44+-0.29, C: 0.29+-0.19, E: 0.28+-0.18
Email:
F: 0.37+-0.31, R: 0.21+-0.21, E: 0.04+-0.07
Web:
F: 0.24+-0.27, V: 0.19+-0.24, E: 0.19+-0.24
```

